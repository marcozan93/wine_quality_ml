# wine_quality_ml
App to predict the quality of wines. A complete description of this project can be foun din this Medium article https://medium.com/@marcozaninitaly/end-to-end-machine-learning-using-fastapi-streamlit-docker-google-cloud-platform-fcdf9f9216e0

Technologies: python, sklearn, fastAPI, Streamlit, Docker.

The structure of the repo is as follows:
```
├───docker-compose.yml
├───backend
│   └─── RFModel.pkl
|   └─── main.py
|   └─── Dockerfile
├───data
|   └─── WineQT.csv
└───interface
    └─── app.py
    └─── Dockerfile
```
- <code>app</code> folder includes the fastAPI code and its associated Dockerfile.
- <code>data</code> folder includes the data used for model training and testing.
- <code>interface</code> folder incldues the frontend of the streamlit app including its associated Dockerfile.
- <code>notebook_predictions.ipynb</code> was used to cerate the model.

## To run the app locally using docker compose:
Edit the uncomment out line 84 of <code>app.py</code> as this is used in Cloud Run (GCP).<br>
Open a terminal (cmd), make sure that docker daemon is running, then run:<br>
<code>docker compose build</code><br>
and successively<br>
<code>docker compose up</code>


## App Deployment on Google Cloud Platform
This application is currently hosted on Google Cloud Platform using Cloud Build <br>
to create two separate images of the interface and backend, and Cloud Run which<br>
creates two separate services (i.e., one for backend and one for interface).

The two services are communicationg with each other as they are public services. The app can<br>
be accessed at the following link https://myimage-lc3ojkzooa-ew.a.run.app/ from desktop or mobile.

The steps to host the app on Google Cloud Platform are:
1. Create a GCP billing account.
2. Enable Cloud Build and Cloud Run APIs.
3. Create a <code>cloudbuild.yml</code> in the same location as your <code>docker-compose.yml</code>.
4. Connect Cloud Build to a GitHub repository to set up a trigger when the <code>main</code> branch is updated.
5. Once the trigger hass started and completed successfully, you can find your images in Artifact Registry on GCP.
6. Create the two CLoud Run services for the interface and backend. The interface is using the same URL generated by GCP for the bakend service to do requests.
